<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>DingDing API Documentation</title>
    <style>
        body { font-family: sans-serif; line-height: 1.6; margin: 20px; background-color: #f4f4f9; }
        .container { max-width: 1200px; margin: auto; background: #fff; padding: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1, h2, h3 { color: #333; border-bottom: 1px solid #ddd; padding-bottom: 10px; }
        .summary-box { background-color: #eef; border-left: 5px solid #007bff; padding: 15px; margin: 20px 0; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; border: 1px solid #ddd; text-align: left; }
        th { background-color: #f8f8f8; }
        code { background-color: #eee; padding: 2px 5px; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>&#128214; DingDing API Documentation (v1.0)</h1>
        
        <h2>1. 프로젝트 개요</h2>
        <p><strong>DingDing</strong>은 아이돌 팬과 아티스트(��이돌, 매니저, 관리자)를 위한 스케줄 관리 및 팬덤 활동 지원 플랫폼의 백엔드 API 서버입니다. 역할 기반의 사용자 시스템을 통해 각 사용자에게 맞춤화된 기능을 제공합니다.</p>

        <h2>2. API 공통 규칙</h2>
        <ul>
            <li><strong>Base URL:</strong> <code>/api/v1/</code></li>
            <li><strong>인증:</strong> 로그인이 필요한 모든 API는 HTTP Header에 <code>Authorization: Bearer &lt;access_token&gt;</code>을 포함해야 합니다.</li>
            <li><strong>페이지네이션:</strong> 목록 조회 API는 기본적으로 페이지네이션이 적용되어 있으며, <code>next</code>, <code>previous</code>, <code>results</code> 필드를 포함한 객체를 반환합니다.</li>
        </ul>

        <h2>3. 핵심 워크플로우</h2>
        <div class="summary-box">
            <ol>
                <li><strong>관리자:</strong> 관리자 페이지에서 '매니저'와 '아이돌' 계정을 생성합니다.</li>
                <li><strong>관리자:</strong> '매니저-아이돌 담당 설정' 기능으로 어떤 매니저가 어떤 아이돌을 담당할지 지정합니다.</li>
                <li><strong>매니저:</strong> 로그인 후, 담당 아이돌을 확인하고 '새 그룹 생성' 기능으로 그룹을 만듭니다.</li>
                <li><strong>매니저:</strong> 담당 아이돌을 생성된 그룹에 배정하고, 개인 또는 그룹 스케줄을 등록합니다.</li>
                <li><strong>아이돌:</strong> 로그인하면 자신의 개인 스케줄과 소속 그룹의 스케줄을 함께 확인합니다.</li>
                <li><strong>팬:</strong> 아이돌이나 그룹을 북마크하면, 관련 스케줄이 '내 스케줄'에 자동으로 연동됩니다.</li>
            </ol>
        </div>

        <h2>4. Users & Admins API</h2>
        <div class="summary-box">
            <strong>핵심 요약:</strong> 사용자 인증(회원가입, 로그인)과 계정 관리의 기반이 되는 API입니다. 특히 관리자(Admin)는 이 API들을 통해 모든 사용자를 제어하고, 매니저-아이돌 관계를 설정하는 등 시스템의 핵심적인 권한을 행사합니다.
        </div>
        <table>
            <thead><tr><th>기능</th><th>Method</th><th>URL</th><th>권한</th><th>설명</th></tr></thead>
            <tbody>
                <tr><td>회원가입</td><td><code>POST</code></td><td>/users/signup/</td><td>누구나</td><td>이메일, 닉네임, 비밀번호로 사용자 생성</td></tr>
                <tr><td>로그인</td><td><code>POST</code></td><td>/users/login/</td><td>누구나</td><td>성공 시 Access/Refresh 토큰 발급</td></tr>
                <tr><td>로그아웃</td><td><code>POST</code></td><td>/users/logout/</td><td>인증된 사용자</td><td>Refresh 토큰을 블랙리스트 처리</td></tr>
                <tr><td>프로필 조회/수정</td><td><code>GET</code>, <code>PATCH</code></td><td>/users/mypage/</td><td>인증된 사용자</td><td>닉네임, 프로필 이미지 등 수정</td></tr>
                <tr><td>비밀번호 변경 (1단계: 확인)</td><td><code>POST</code></td><td>/users/password/verify/</td><td>인증된 사용자</td><td>현재 비밀번호를 확인</td></tr>
                <tr><td>비밀번호 변경 (2단계: 변경)</td><td><code>PATCH</code></td><td>/users/password/change/</td><td>인증된 사용자</td><td>새 비밀번호로 변경</td></tr>
                <tr><td>팬 메인보드</td><td><code>GET</code></td><td>/users/mainboard/</td><td>팬</td><td>북마크 기반 오늘 스케줄 조회</td></tr>
                <tr><td>카카오/구글 로그인</td><td><code>GET</code></td><td>/users/kakao/callback/<br>/users/google/callback/</td><td>누구나</td><td>소셜 로그인 콜백 처리</td></tr>
                <tr><td><b>[관리자]</b> 전체 사용자 목록</td><td><code>GET</code></td><td>/admins/users/</td><td>관리자</td><td>역할/이름/가입일 등으로 검색, 정렬, 필터링 가능</td></tr>
                <tr><td><b>[관리자]</b> 사용자 강제 탈퇴</td><td><code>DELETE</code></td><td>/admins/users/{user_id}/</td><td>관리자</td><td>특정 사용자 계정을 삭제</td></tr>
                <tr><td><b>[관리자]</b> 매니저/아이돌 계정 생성</td><td><code>POST</code></td><td>/admins/create-manager/<br>/admins/create-idol/</td><td>관리자</td><td>역할이 지정된 사용자 계정을 생성</td></tr>
                <tr><td><b>[관리자]</b> 담당 매니저 지정/해제</td><td><code>POST</code>/<code>DELETE</code></td><td>/admins/managers/<br>/admins/managers/{assignment_id}/</td><td>관리자</td><td>매니저와 아이돌의 담당 관계를 설정하거나 해제</td></tr>
            </tbody>
        </table>

        <h2>5. Groups, Idols & Bookmarks API</h2>
        <div class="summary-box">
            <strong>핵심 요약:</strong> 서비스의 주요 대상인 아이돌과 그룹의 정보를 관리하고, 팬들이 이들을 '북마크'하여 상호작용하는 핵심 기능을 담당합니다. 매니저는 이 API를 통해 그룹을 생성하고 아이돌을 배정하며, 팬들은 북마크를 통해 스케줄 자동 연동의 혜택을 받습니다.
        </div>
        <table>
            <thead><tr><th>기능</th><th>Method</th><th>URL</th><th>권한</th><th>설명</th></tr></thead>
            <tbody>
                <tr><td>그룹 목록/생성</td><td><code>GET</code>/<code>POST</code></td><td>/groups/</td><td>GET: 누구나<br>POST: 매니저/관리자</td><td>그룹을 조회하거나 새 그룹을 생성</td></tr>
                <tr><td>그룹 상세/수정/삭제</td><td><code>GET</code>/<code>PUT</code>/<code>PATCH</code>/<code>DELETE</code></td><td>/groups/{group_id}/</td><td>GET: 누구나<br>나머지: 담당 매니저/관리자</td><td>특정 그룹의 정보를 관리</td></tr>
                <tr><td>아이돌 목록</td><td><code>GET</code></td><td>/idols/</td><td>인증된 사용자</td><td><code>?search=</code> 쿼리로 이름 검색 가능</td></tr>
                <tr><td>아이돌 상세</td><td><code>GET</code></td><td>/idols/{idol_id}/</td><td>인증된 사용자</td><td>특정 아이돌의 상세 정보 조회</td></tr>
                <tr><td>아이돌 메인보드</td><td><code>GET</code></td><td>/idols/mainboard/</td><td>아이돌</td><td>자신의 오늘 스케줄 조회</td></tr>
                <tr><td><b>[매니저]</b> 아이돌 그룹 변경</td><td><code>PATCH</code></td><td>/idols/{idol_id}/update-group/</td><td>담당 매니저/관리자</td><td><code>{ "group": group_id }</code> 형식으로 아이돌의 소속 그룹을 변경</td></tr>
                <tr><td>북마크 목록/생성</td><td><code>GET</code>/<code>POST</code></td><td>/bookmarks/idols/<br>/bookmarks/groups/</td><td>인증된 사용자</td><td>아이돌 또는 그룹을 북마크</td></tr>
                <tr><td>북마크 삭제</td><td><code>DELETE</code></td><td>/bookmarks/idols/{bookmark_id}/<br>/bookmarks/groups/{bookmark_id}/</td><td>인증된 사용자</td><td>특정 북마크를 삭제</td></tr>
            </tbody>
        </table>

        <h2>6. Schedules & Chats API</h2>
        <div class="summary-box">
            <strong>핵심 요약:</strong> 서비스의 가장 핵심적인 기능인 스케줄을 관리하고, 팬들 간의 소통을 위한 채팅 기능을 제공합니다. 매니저는 아이돌/그룹 스케줄을 생성하고, 팬들은 북마크를 통해 이 스케줄들을 자신의 캘린더처럼 받아볼 수 있습니다.
        </div>
        <table>
            <thead><tr><th>기능</th><th>Method</th><th>URL</th><th>권한</th><th>설명</th></tr></thead>
            <tbody>
                <tr><td>아이돌 스케줄 CRUD</td><td>모두</td><td>/schedules/idols/{schedule_id}/</td><td>담당 매니저/관리자</td><td>아이돌 개인 스케줄을 생성, 조회, 수정, 삭제</td></tr>
                <tr><td>그룹 스케줄 CRUD</td><td>모두</td><td>/schedules/groups/{schedule_id}/</td><td>담당 매니저/관리자</td><td>그룹 스케줄을 생성, 조회, 수정, 삭제</td></tr>
                <tr><td>내 스케줄 목록</td><td><code>GET</code></td><td>/schedules/my/</td><td>인증된 사용자</td><td>북마크를 통해 연동된 모든 스케줄을 조회</td></tr>
                <tr><td><b>[매니저]</b> 메인보드</td><td><code>GET</code></td><td>/schedules/manager/mainboard/</td><td>매니저</td><td>담당 아이돌의 오늘 스케줄 조회</td></tr>
                <tr><td>채팅방 CRUD</td><td>모두</td><td>/chats/rooms/{room_pk}/</td><td>인증된 사용자</td><td>채팅방 생성, 조회, 수정, 삭제</td></tr>
                <tr><td>채팅방 참여/나가기</td><td><code>POST</code></td><td>/chats/rooms/{room_pk}/join/<br>/chats/rooms/{room_pk}/leave/</td><td>인증된 사용자</td><td>채팅방에 참여하거나 나감</td></tr>
                <tr><td>웹소켓 연결</td><td><code>WEBSOCKET</code></td><td>/ws/chats/{room_name}/</td><td>인증된 사용자</td><td>실시간 채팅을 위한 웹소켓 연결</td></tr>
            </tbody>
        </table>
    </div>
</body>
</html>
